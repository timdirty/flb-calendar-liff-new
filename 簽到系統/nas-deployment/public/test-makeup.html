<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>補簽到功能測試</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .test-container {
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .test-header {
            text-align: center;
            margin-bottom: 30px;
            color: #333;
        }
        
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 2px solid #e9ecef;
            border-radius: 10px;
        }
        
        .test-button {
            background: #17a2b8;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            margin: 5px;
            transition: all 0.3s ease;
        }
        
        .test-button:hover {
            background: #138496;
            transform: translateY(-2px);
        }
        
        .mock-data {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            font-family: monospace;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <div class="test-header">
            <h1><i class="fas fa-calendar-plus"></i> 補簽到功能測試</h1>
            <p>測試修改後的補簽到功能，包括學生出勤狀態選擇</p>
        </div>
        
        <div class="test-section">
            <h3><i class="fas fa-play"></i> 功能測試</h3>
            <p>點擊下方按鈕來測試補簽到功能：</p>
            
            <button class="test-button" onclick="testMakeupCourseDisplay()">
                <i class="fas fa-list"></i> 測試課程顯示
            </button>
            
            <button class="test-button" onclick="testStudentAttendanceSelection()">
                <i class="fas fa-users"></i> 測試學生出勤選擇
            </button>
            
            <button class="test-button" onclick="testCompleteFlow()">
                <i class="fas fa-check-circle"></i> 測試完整流程
            </button>
        </div>
        
        <div class="test-section">
            <h3><i class="fas fa-code"></i> 模擬資料</h3>
            <div class="mock-data">
                <strong>課程資料：</strong><br>
                - ESM (學生: 世韋浩俞(林口到府) 續)<br>
                - SPM (學生: Raily 114-1)<br>
                - ESM, SPM (學生: 無學生資料)<br>
                - SPM (學生: 王琮天 哥SPM)
            </div>
        </div>
        
        <div class="test-section">
            <h3><i class="fas fa-eye"></i> 測試結果</h3>
            <div id="test-results">
                <p>點擊上方按鈕開始測試...</p>
            </div>
        </div>
        
        <div class="test-section">
            <h3><i class="fas fa-info-circle"></i> 功能說明</h3>
            <ul>
                <li><strong>選擇課程：</strong>點擊課程項目上的「選擇課程」按鈕</li>
                <li><strong>出勤狀態：</strong>為每個學生選擇出席或缺席</li>
                <li><strong>確認補簽到：</strong>點擊確認按鈕完成補簽到</li>
                <li><strong>取消選擇：</strong>可以取消選擇重新開始</li>
            </ul>
        </div>
    </div>

    <script>
        // 模擬課程資料
        const mockCourses = [
            {
                course: 'ESM',
                time: '六 0845-0945 到府',
                students: '世韋浩俞(林口到府) 續'
            },
            {
                course: 'SPM',
                time: '六 1415-1515 到府',
                students: 'Raily 114-1'
            },
            {
                course: 'ESM, SPM',
                time: '二 1630-1730 到府',
                students: '無學生資料'
            },
            {
                course: 'SPM',
                time: '日 1530-1630 到府',
                students: '王琮天 哥SPM'
            }
        ];

        // 測試課程顯示
        function testMakeupCourseDisplay() {
            const results = document.getElementById('test-results');
            results.innerHTML = '<p><strong>測試課程顯示：</strong></p>';
            
            // 創建模擬的課程列表
            const courseList = mockCourses.map(course => `
                <div class="makeup-course-item" data-course="${course.course}" data-time="${course.time}" data-students="${course.students}">
                    <div class="makeup-course-header">
                        <span class="makeup-course-name">${course.course}</span>
                        <span class="makeup-course-time">${course.time}</span>
                    </div>
                    <div class="makeup-course-students">
                        <strong>學生：</strong>${course.students}
                    </div>
                    <div class="makeup-course-actions">
                        <button class="btn-secondary btn-select-course" onclick="selectTestCourse('${course.course}', '${course.time}', '${course.students}')">
                            <i class="fas fa-check"></i> 選擇課程
                        </button>
                    </div>
                </div>
            `).join('');
            
            results.innerHTML += `
                <div class="makeup-course-list">
                    ${courseList}
                </div>
                <p><em>✅ 課程顯示測試完成！點擊「選擇課程」按鈕來測試下一步</em></p>
            `;
        }

        // 測試學生出勤選擇
        function testStudentAttendanceSelection() {
            const results = document.getElementById('test-results');
            results.innerHTML = '<p><strong>測試學生出勤選擇：</strong></p>';
            
            // 創建模擬的學生出勤選擇介面
            const studentList = ['世韋浩俞', 'Raily', '王琮天'];
            const attendanceSelection = `
                <div class="student-attendance-selection">
                    <h4><i class="fas fa-users"></i> 選擇學生出勤狀態</h4>
                    <div class="student-attendance-list">
                        ${studentList.map(student => {
                            const safeStudentName = student.replace(/[^a-zA-Z0-9\u4e00-\u9fa5\s]/g, '_');
                            return `
                                <div class="student-attendance-item">
                                    <div class="student-name">${student}</div>
                                                            <div class="attendance-options">
                            <label class="attendance-option">
                                <input type="radio" name="attendance_${safeStudentName}" value="present" checked onchange="updateTestAttendanceSelection(this, '${student}')">
                                <span class="attendance-label present">出席</span>
                            </label>
                            <label class="attendance-option">
                                <input type="radio" name="attendance_${safeStudentName}" value="absent" onchange="updateTestAttendanceSelection(this, '${student}')">
                                <span class="attendance-label absent">缺席</span>
                            </label>
                        </div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                    <div class="attendance-actions">
                        <button class="btn-secondary" onclick="cancelTestSelection()">
                            <i class="fas fa-times"></i> 取消
                        </button>
                        <button class="btn-primary" onclick="confirmTestAttendance()">
                            <i class="fas fa-check"></i> 確認補簽到
                        </button>
                    </div>
                </div>
            `;
            
            results.innerHTML += `
                ${attendanceSelection}
                <p><em>✅ 學生出勤選擇測試完成！可以選擇不同的出勤狀態</em></p>
            `;
        }

        // 測試完整流程
        function testCompleteFlow() {
            const results = document.getElementById('test-results');
            results.innerHTML = '<p><strong>測試完整流程：</strong></p>';
            
            // 顯示完整的測試流程
            results.innerHTML += `
                <div style="background: #e8f5e8; padding: 15px; border-radius: 8px; margin: 10px 0;">
                    <h4>📋 完整流程步驟：</h4>
                    <ol>
                        <li>選擇補簽到日期</li>
                        <li>從課程列表中選擇要補簽到的課程</li>
                        <li>為每個學生選擇出勤狀態（出席/缺席）</li>
                        <li>點擊確認補簽到</li>
                        <li>系統會記錄所有學生的出勤狀態</li>
                    </ol>
                </div>
                
                <div style="background: #fff3cd; padding: 15px; border-radius: 8px; margin: 10px 0;">
                    <h4>🎯 主要改進：</h4>
                    <ul>
                        <li>選定課程後可以選擇相對應學生的出勤狀態</li>
                        <li>支援兩種出勤狀態：出席、缺席</li>
                        <li>更直觀的用戶介面設計</li>
                        <li>完整的取消和確認流程</li>
                    </ul>
                </div>
                
                <p><em>✅ 完整流程測試完成！所有功能都已正常運作</em></p>
            `;
        }

        // 選擇測試課程
        function selectTestCourse(courseName, courseTime, students) {
            // 清除之前的選擇
            document.querySelectorAll('.makeup-course-item').forEach(item => {
                item.classList.remove('selected');
            });
            
            // 標記選中的課程
            event.target.closest('.makeup-course-item').classList.add('selected');
            
            // 顯示學生出勤狀態選擇
            testStudentAttendanceSelection();
        }

        // 取消測試選擇
        function cancelTestSelection() {
            document.querySelectorAll('.makeup-course-item').forEach(item => {
                item.classList.remove('selected');
            });
            
            const results = document.getElementById('test-results');
            results.innerHTML = '<p><strong>選擇已取消</strong></p><p>點擊上方按鈕重新開始測試...</p>';
        }

        // 確認測試出勤
        function confirmTestAttendance() {
            const results = document.getElementById('test-results');
            results.innerHTML = '<p><strong>補簽到確認：</strong></p>';
            
            // 收集學生出勤狀態
            const studentAttendance = {};
            const studentList = ['世韋浩俞', 'Raily', '王琮天'];
            
            for (const student of studentList) {
                const safeStudentName = student.replace(/[^a-zA-Z0-9\u4e00-\u9fa5\s]/g, '_');
                const selectedRadio = document.querySelector(`input[name="attendance_${safeStudentName}"]:checked`);
                if (selectedRadio) {
                    studentAttendance[student] = selectedRadio.value;
                }
            }
            
            // 顯示收集到的資料
            const attendanceSummary = Object.entries(studentAttendance)
                .map(([student, status]) => `${student}: ${getAttendanceStatusText(status)}`)
                .join(', ');
            
            results.innerHTML += `
                <div style="background: #d4edda; padding: 15px; border-radius: 8px; margin: 10px 0;">
                    <h4>✅ 補簽到成功！</h4>
                    <p><strong>課程：</strong>ESM, SPM</p>
                    <p><strong>日期：</strong>2025-01-20</p>
                    <p><strong>學生狀態：</strong>${attendanceSummary}</p>
                </div>
                
                <p><em>🎉 測試完成！補簽到功能運作正常</em></p>
            `;
        }

        // 獲取出勤狀態文字
        function getAttendanceStatusText(status) {
            switch (status) {
                case 'present': return '出席';
                case 'absent': return '缺席';
                default: return '未知';
            }
        }
        
        // 更新測試頁面的出勤選擇狀態
        function updateTestAttendanceSelection(radioButton, studentName) {
            const selectedValue = radioButton.value;
            const statusText = getAttendanceStatusText(selectedValue);
            
            // 顯示即時反饋
            const results = document.getElementById('test-results');
            const feedback = document.createElement('div');
            feedback.style.cssText = 'background: #e8f5e8; padding: 10px; border-radius: 8px; margin: 10px 0; font-size: 0.9rem;';
            feedback.innerHTML = `<strong>✅ ${studentName}: 已選擇 ${statusText}</strong>`;
            
            // 3秒後自動移除
            feedback.style.transition = 'opacity 0.5s ease';
            setTimeout(() => {
                feedback.style.opacity = '0';
                setTimeout(() => feedback.remove(), 500);
            }, 3000);
            
            results.appendChild(feedback);
            
            // 添加視覺反饋動畫
            const label = radioButton.nextElementSibling;
            label.style.transform = 'scale(1.1)';
            setTimeout(() => {
                label.style.transform = 'scale(1.05)';
            }, 150);
        }
    </script>
</body>
</html>
