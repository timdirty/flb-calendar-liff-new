# 🎯 測試系統使用指南

## 📋 系統概述

測試系統已成功修復，現在具備以下功能：
- ✅ **真實 CalDAV 資料載入** - 與正式版相同的資料來源
- ✅ **個別課程直接簽到** - 每個課程卡片都有簽到按鈕
- ✅ **CSP 錯誤修復** - 完全符合安全政策
- ✅ **優化用戶體驗** - 流暢的動畫和互動效果

## 🚀 訪問方式

### Railway 部署
```
https://your-railway-app.railway.app/test
```

### 本地測試
```
http://localhost:3000/test
```

## 🎯 主要功能

### 1. 真實資料載入
- **行事曆事件**：從 CalDAV 伺服器獲取真實課程資料
- **講師列表**：載入實際的講師資訊
- **自動備援**：API 失敗時自動使用測試資料

### 2. 直接簽到功能
- **個別課程按鈕**：每個課程卡片底部都有「直接簽到」按鈕
- **智慧顯示**：僅在今日或未來課程顯示簽到按鈕
- **一鍵跳轉**：直接跳轉到簽到系統的對應步驟

### 3. 簽到系統整合
- **快速簽到**：選擇講師後快速簽到今日課程
- **課程選擇**：彈出對話框選擇要簽到的課程
- **報表查看**：查看講師的簽到記錄

## 🎨 用戶界面

### 課程卡片設計
```
┌─────────────────────────────────┐
│ 📅 課程標題                     │
│ 👤 講師名稱                     │
│ 🕐 時間範圍                     │
│ 📅 日期資訊                     │
│ 📍 地點資訊 (如有)              │
│ ─────────────────────────────── │
│ [🎯 直接簽到] 按鈕              │
└─────────────────────────────────┘
```

### 簽到按鈕樣式
- **顏色**：綠色漸層背景
- **位置**：課程卡片底部
- **動畫**：hover 效果和點擊反饋
- **條件**：僅在今日或未來課程顯示

## 🔧 技術特色

### API 端點修復
```javascript
// 行事曆資料
const response = await fetch('/api/events');

// 講師列表
const response = await fetch('/api/teachers');
```

### 直接簽到處理
```javascript
async function handleDirectAttendance(title, instructor, start, end) {
    const attendanceUrl = `https://liff.line.me/1657746214-wPgd2qQn?step=3&teacher=${instructor}&course=${title}&time=${timeString}`;
    // 開啟簽到系統...
}
```

### 事件監聽器
```javascript
// 替代內聯 onclick，符合 CSP 政策
btn.addEventListener('click', function() {
    handleDirectAttendance(title, instructor, start, end);
});
```

## 📱 使用流程

### 1. 基本操作
1. 開啟測試頁面
2. 等待系統載入真實資料
3. 選擇講師或查看全部課程
4. 瀏覽行事曆事件

### 2. 直接簽到
1. 找到今日或未來的課程
2. 點擊課程卡片中的「直接簽到」按鈕
3. 系統自動跳轉到簽到系統
4. 完成簽到流程

### 3. 快速簽到
1. 選擇講師
2. 點擊「快速簽到」按鈕
3. 從彈出對話框選擇課程
4. 自動跳轉到對應的簽到步驟

## 🎯 功能對比

| 功能 | 修復前 | 修復後 |
|------|--------|--------|
| 資料來源 | ❌ 測試資料 | ✅ 真實 CalDAV |
| API 連接 | ❌ 404 錯誤 | ✅ 正確端點 |
| CSP 合規 | ❌ 內聯事件 | ✅ 事件監聽器 |
| 直接簽到 | ❌ 無此功能 | ✅ 個別課程按鈕 |
| 用戶體驗 | ⚠️ 基本 | ✅ 優化動畫 |

## 🚨 注意事項

### 1. 資料載入
- 首次載入可能需要幾秒鐘
- 如果 API 失敗，會自動使用測試資料
- 可以點擊右下角重新整理按鈕強制重新載入

### 2. 簽到功能
- 需要 LINE 環境才能使用 LIFF 功能
- 在一般瀏覽器中會使用 `window.open` 開啟
- 確保簽到系統 URL 正確配置

### 3. 瀏覽器相容性
- 支援現代瀏覽器 (Chrome, Firefox, Safari, Edge)
- 需要 JavaScript 啟用
- 建議使用最新版本瀏覽器

## 🔍 故障排除

### 1. 資料無法載入
- 檢查網路連接
- 確認 API 伺服器正常運作
- 查看瀏覽器控制台錯誤訊息

### 2. 簽到按鈕無反應
- 確認課程是今日或未來時間
- 檢查 JavaScript 是否啟用
- 查看控制台是否有錯誤

### 3. 頁面載入緩慢
- 清除瀏覽器快取
- 檢查網路速度
- 嘗試重新整理頁面

## 📞 技術支援

如果遇到問題，請檢查：
1. 瀏覽器控制台錯誤訊息
2. 網路連接狀態
3. API 伺服器狀態
4. 系統日誌輸出

---

**🎉 測試系統已完全修復，現在可以像正式版一樣獲取真實資料並提供完整的簽到功能！**
