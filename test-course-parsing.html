<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>èª²ç¨‹æ¨™é¡Œè§£ææ¸¬è©¦</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        .header h1 {
            color: #333;
            margin-bottom: 10px;
        }
        .header p {
            color: #666;
            font-size: 1.1rem;
        }
        .test-section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            border-left: 4px solid #007bff;
        }
        .test-section h3 {
            color: #007bff;
            margin-top: 0;
        }
        .test-case {
            background: white;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            border: 1px solid #e9ecef;
        }
        .test-input {
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }
        .test-result {
            display: flex;
            gap: 20px;
            margin-top: 10px;
        }
        .result-item {
            flex: 1;
            padding: 10px;
            border-radius: 5px;
            background: #f8f9fa;
        }
        .result-label {
            font-weight: bold;
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 5px;
        }
        .result-value {
            color: #333;
            font-family: 'Courier New', monospace;
        }
        .btn {
            background: linear-gradient(135deg, #007bff, #0056b3);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            margin: 10px 5px;
        }
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 123, 255, 0.3);
        }
        .btn-success {
            background: linear-gradient(135deg, #28a745, #1e7e34);
        }
        .log {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 15px;
            margin-top: 20px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            max-height: 300px;
            overflow-y: auto;
        }
        .log-entry {
            margin-bottom: 5px;
            padding: 2px 0;
        }
        .log-success {
            color: #28a745;
        }
        .log-error {
            color: #dc3545;
        }
        .log-info {
            color: #007bff;
        }
        .log-warning {
            color: #ffc107;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“ èª²ç¨‹æ¨™é¡Œè§£ææ¸¬è©¦</h1>
            <p>æ¸¬è©¦èª²ç¨‹æ¨™é¡Œè§£æåŠŸèƒ½ï¼Œé©—è­‰èª²ç¨‹åç¨±å’Œæ™‚é–“è³‡è¨Šçš„åˆ†é›¢</p>
        </div>

        <div class="test-section">
            <h3>ğŸ§ª æ¸¬è©¦æ¡ˆä¾‹</h3>
            <div id="test-cases">
                <!-- æ¸¬è©¦æ¡ˆä¾‹å°‡åœ¨é€™è£¡å‹•æ…‹ç”Ÿæˆ -->
            </div>
        </div>

        <div style="text-align: center; margin: 30px 0;">
            <button class="btn" onclick="runAllTests()">ğŸš€ åŸ·è¡Œæ‰€æœ‰æ¸¬è©¦</button>
            <button class="btn btn-success" onclick="addCustomTest()">â• æ·»åŠ è‡ªå®šç¾©æ¸¬è©¦</button>
            <button class="btn" onclick="clearLog()">ğŸ—‘ï¸ æ¸…é™¤æ—¥èªŒ</button>
        </div>

        <div class="log" id="test-log">
            <div class="log-entry log-info">æº–å‚™é–‹å§‹æ¸¬è©¦...</div>
        </div>
    </div>

    <script>
        // èª²ç¨‹æ¨™é¡Œè§£æå‡½æ•¸ï¼ˆèˆ‡ä¸»ç³»çµ±ç›¸åŒï¼‰
        function parseCourseTitle(fullTitle) {
            if (!fullTitle) {
                return { courseName: 'æœªå‘½åèª²ç¨‹', timeInfo: '' };
            }

            // å¸¸è¦‹çš„æ™‚é–“æ¨¡å¼
            const timePatterns = [
                // å…­ 9:30-10:30 åˆ°åºœ
                /([ä¸€äºŒä¸‰å››äº”å…­æ—¥])\s+(\d{1,2}:\d{2})-(\d{1,2}:\d{2})\s+(.+)/,
                // å…­ 9:30-10:30
                /([ä¸€äºŒä¸‰å››äº”å…­æ—¥])\s+(\d{1,2}:\d{2})-(\d{1,2}:\d{2})/,
                // 9:30-10:30 åˆ°åºœ
                /(\d{1,2}:\d{2})-(\d{1,2}:\d{2})\s+(.+)/,
                // 9:30-10:30
                /(\d{1,2}:\d{2})-(\d{1,2}:\d{2})/,
                // ç¬¬Xé€±
                /ç¬¬(\d+)é€±/,
                // è«‹å‡
                /è«‹å‡/
            ];

            let courseName = fullTitle;
            let timeInfo = '';

            // å˜—è©¦åŒ¹é…å„ç¨®æ™‚é–“æ¨¡å¼
            for (const pattern of timePatterns) {
                const match = fullTitle.match(pattern);
                if (match) {
                    if (pattern.source.includes('è«‹å‡')) {
                        // è™•ç†è«‹å‡æƒ…æ³
                        courseName = fullTitle.replace(/è«‹å‡.*$/, '').trim();
                        timeInfo = 'è«‹å‡';
                        break;
                    } else if (pattern.source.includes('ç¬¬') && pattern.source.includes('é€±')) {
                        // è™•ç†é€±æ¬¡
                        const weekMatch = fullTitle.match(/ç¬¬(\d+)é€±/);
                        if (weekMatch) {
                            courseName = fullTitle.replace(/ç¬¬\d+é€±.*$/, '').trim();
                            timeInfo = `ç¬¬${weekMatch[1]}é€±`;
                        }
                        break;
                    } else if (pattern.source.includes('ä¸€äºŒä¸‰å››äº”å…­æ—¥')) {
                        // è™•ç†åŒ…å«æ˜ŸæœŸå’Œæ™‚é–“çš„æƒ…æ³
                        const weekday = match[1];
                        const startTime = match[2];
                        const endTime = match[3];
                        const location = match[4] || '';
                        
                        courseName = fullTitle.replace(new RegExp(`${weekday}\\s+${startTime}-${endTime}\\s*${location}.*$`), '').trim();
                        timeInfo = `${weekday} ${startTime}-${endTime}${location ? ' ' + location : ''}`;
                        break;
                    } else if (pattern.source.includes('\\d{1,2}:\\d{2}')) {
                        // è™•ç†åªæœ‰æ™‚é–“çš„æƒ…æ³
                        const startTime = match[1];
                        const endTime = match[2];
                        const location = match[3] || '';
                        
                        courseName = fullTitle.replace(new RegExp(`${startTime}-${endTime}\\s*${location}.*$`), '').trim();
                        timeInfo = `${startTime}-${endTime}${location ? ' ' + location : ''}`;
                        break;
                    }
                }
            }

            // å¦‚æœæ²’æœ‰åŒ¹é…åˆ°æ™‚é–“æ¨¡å¼ï¼Œå˜—è©¦ç°¡å–®çš„åˆ†å‰²
            if (timeInfo === '') {
                // æª¢æŸ¥æ˜¯å¦åŒ…å«æ™‚é–“æ ¼å¼
                const timeMatch = fullTitle.match(/(\d{1,2}:\d{2})-(\d{1,2}:\d{2})/);
                if (timeMatch) {
                    const timeIndex = fullTitle.indexOf(timeMatch[0]);
                    courseName = fullTitle.substring(0, timeIndex).trim();
                    timeInfo = fullTitle.substring(timeIndex).trim();
                }
            }

            // æ¸…ç†èª²ç¨‹åç¨±
            courseName = courseName.replace(/[ç¬¬\d+é€±è«‹å‡].*$/, '').trim();
            
            // å¦‚æœèª²ç¨‹åç¨±ç‚ºç©ºï¼Œä½¿ç”¨åŸå§‹æ¨™é¡Œ
            if (!courseName) {
                courseName = fullTitle;
                timeInfo = '';
            }

            return { courseName, timeInfo };
        }

        // æ¸¬è©¦æ¡ˆä¾‹
        const testCases = [
            {
                input: 'ESM å…­ 9:30-10:30 åˆ°åºœ ç¬¬4é€±è«‹å‡',
                expected: { courseName: 'ESM', timeInfo: 'å…­ 9:30-10:30 åˆ°åºœ' }
            },
            {
                input: 'SPM å…­ 9:30-11:00 åˆ°åºœ ç¬¬2é€±',
                expected: { courseName: 'SPM', timeInfo: 'å…­ 9:30-11:00 åˆ°åºœ' }
            },
            {
                input: 'æ•¸å­¸ ä¸€ 14:00-15:30 æ•™å®¤A',
                expected: { courseName: 'æ•¸å­¸', timeInfo: 'ä¸€ 14:00-15:30 æ•™å®¤A' }
            },
            {
                input: 'è‹±æ–‡ 9:30-10:30 ç·šä¸Š',
                expected: { courseName: 'è‹±æ–‡', timeInfo: '9:30-10:30 ç·šä¸Š' }
            },
            {
                input: 'ç‰©ç† ç¬¬3é€±',
                expected: { courseName: 'ç‰©ç†', timeInfo: 'ç¬¬3é€±' }
            },
            {
                input: 'åŒ–å­¸ è«‹å‡',
                expected: { courseName: 'åŒ–å­¸', timeInfo: 'è«‹å‡' }
            },
            {
                input: 'ç”Ÿç‰© 9:30-10:30',
                expected: { courseName: 'ç”Ÿç‰©', timeInfo: '9:30-10:30' }
            },
            {
                input: 'ç°¡å–®èª²ç¨‹',
                expected: { courseName: 'ç°¡å–®èª²ç¨‹', timeInfo: '' }
            }
        ];

        function log(message, type = 'info') {
            const logContainer = document.getElementById('test-log');
            const entry = document.createElement('div');
            entry.className = `log-entry log-${type}`;
            entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            logContainer.appendChild(entry);
            logContainer.scrollTop = logContainer.scrollHeight;
        }

        function createTestCaseElement(testCase, index) {
            const result = parseCourseTitle(testCase.input);
            const isCorrect = result.courseName === testCase.expected.courseName && 
                             result.timeInfo === testCase.expected.timeInfo;

            return `
                <div class="test-case">
                    <div class="test-input">æ¸¬è©¦æ¡ˆä¾‹ ${index + 1}: "${testCase.input}"</div>
                    <div class="test-result">
                        <div class="result-item">
                            <div class="result-label">èª²ç¨‹åç¨±</div>
                            <div class="result-value" style="color: ${isCorrect ? '#28a745' : '#dc3545'}">
                                ${result.courseName}
                                ${result.courseName === testCase.expected.courseName ? ' âœ…' : ' âŒ'}
                            </div>
                        </div>
                        <div class="result-item">
                            <div class="result-label">æ™‚é–“è³‡è¨Š</div>
                            <div class="result-value" style="color: ${isCorrect ? '#28a745' : '#dc3545'}">
                                ${result.timeInfo || '(ç„¡)'}
                                ${result.timeInfo === testCase.expected.timeInfo ? ' âœ…' : ' âŒ'}
                            </div>
                        </div>
                    </div>
                    <div style="margin-top: 10px; font-size: 0.9rem; color: #666;">
                        æœŸæœ›: èª²ç¨‹="${testCase.expected.courseName}", æ™‚é–“="${testCase.expected.timeInfo}"
                    </div>
                </div>
            `;
        }

        function renderTestCases() {
            const container = document.getElementById('test-cases');
            container.innerHTML = testCases.map((testCase, index) => 
                createTestCaseElement(testCase, index)
            ).join('');
        }

        function runAllTests() {
            log('ğŸš€ é–‹å§‹åŸ·è¡Œæ‰€æœ‰æ¸¬è©¦...', 'info');
            
            let passedTests = 0;
            let totalTests = testCases.length;

            testCases.forEach((testCase, index) => {
                const result = parseCourseTitle(testCase.input);
                const isCorrect = result.courseName === testCase.expected.courseName && 
                                 result.timeInfo === testCase.expected.timeInfo;

                if (isCorrect) {
                    passedTests++;
                    log(`âœ… æ¸¬è©¦æ¡ˆä¾‹ ${index + 1} é€šé: "${testCase.input}"`, 'success');
                } else {
                    log(`âŒ æ¸¬è©¦æ¡ˆä¾‹ ${index + 1} å¤±æ•—: "${testCase.input}"`, 'error');
                    log(`   æœŸæœ›: èª²ç¨‹="${testCase.expected.courseName}", æ™‚é–“="${testCase.expected.timeInfo}"`, 'error');
                    log(`   å¯¦éš›: èª²ç¨‹="${result.courseName}", æ™‚é–“="${result.timeInfo}"`, 'error');
                }
            });

            const successRate = Math.round((passedTests / totalTests) * 100);
            log(`ğŸ“Š æ¸¬è©¦å®Œæˆ: ${passedTests}/${totalTests} é€šé (${successRate}%)`, 
                successRate === 100 ? 'success' : 'warning');

            if (successRate === 100) {
                log('ğŸ‰ æ‰€æœ‰æ¸¬è©¦é€šéï¼èª²ç¨‹è§£æåŠŸèƒ½æ­£å¸¸', 'success');
            } else if (successRate >= 80) {
                log('âš ï¸ å¤§éƒ¨åˆ†æ¸¬è©¦é€šéï¼Œèª²ç¨‹è§£æåŠŸèƒ½åŸºæœ¬æ­£å¸¸', 'warning');
            } else {
                log('âŒ å¤šé …æ¸¬è©¦å¤±æ•—ï¼Œéœ€è¦æª¢æŸ¥èª²ç¨‹è§£æåŠŸèƒ½', 'error');
            }

            // é‡æ–°æ¸²æŸ“æ¸¬è©¦æ¡ˆä¾‹ä»¥é¡¯ç¤ºçµæœ
            renderTestCases();
        }

        function addCustomTest() {
            const input = prompt('è«‹è¼¸å…¥è¦æ¸¬è©¦çš„èª²ç¨‹æ¨™é¡Œ:');
            if (input) {
                const result = parseCourseTitle(input);
                log(`ğŸ§ª è‡ªå®šç¾©æ¸¬è©¦: "${input}"`, 'info');
                log(`   çµæœ: èª²ç¨‹="${result.courseName}", æ™‚é–“="${result.timeInfo}"`, 'info');
                
                // æ·»åŠ åˆ°æ¸¬è©¦æ¡ˆä¾‹
                testCases.push({
                    input: input,
                    expected: result // ä½¿ç”¨å¯¦éš›çµæœä½œç‚ºæœŸæœ›å€¼
                });
                
                // é‡æ–°æ¸²æŸ“
                renderTestCases();
            }
        }

        function clearLog() {
            document.getElementById('test-log').innerHTML = '<div class="log-entry log-info">æ—¥èªŒå·²æ¸…é™¤</div>';
        }

        // é é¢è¼‰å…¥æ™‚æ¸²æŸ“æ¸¬è©¦æ¡ˆä¾‹
        document.addEventListener('DOMContentLoaded', function() {
            log('é é¢è¼‰å…¥å®Œæˆï¼Œæº–å‚™é–‹å§‹æ¸¬è©¦', 'info');
            renderTestCases();
        });
    </script>
</body>
</html>
